### Requirements 

- Upload videos fast
- Smooth video streaming
- Ability to change video quality
- Clients supported: mobile apps, web browser, and TV

### Video Uploading

Metadata DB: Video metadata are stored in Metadata DB. It is sharded and replicated to meet performance and high availability requirements.

Metadata cache: For better performance, video metadata and user objects are cached.

Original storage: A blob storage system is used to store original videos.

Transcoding servers: Video transcoding is also called video encoding. It is the process of converting a video format to other formats 
(MPEG, HLS, etc), which provide the best video streams possible for different devices and bandwidth capabilities.

CDN: Videos are cached in CDN. When you click the play button, a video is streamed from the CDN.

Completion queue: A message queue that stores information about video transcoding completion events.


### Video Streaming

Popular streaming protocols: MPEG-DASH, Apple HLS, Microsoft Smooth Streaming, dobe HTTP Dynamic Streaming

### Video Transcoding

Why do we need transcoding ? 

- Raw video consumes large amounts of storage space
- Many devices and browsers only support certain types of video formats
- Deliver higher resolution video to users who have high network bandwidth and lower resolution video to users who have low bandwidth
- Switching video quality automatically

2 types of encoding formats

- Container: This is like a basket that contains the video file, audio, and metadata. 
You can tell the container format by the file extension, such as .avi, .mov, or .mp4
- Codecs: These are compression and decompression algorithms aim to reduce the video size while preserving the video quality.
 The most used video codecs are H.264, VP9, and HEVC.

### Directed acyclic graph 

Processing a video is computationally expensive and time-consuming. 
Different content creators may have different video processing requirements.

To support different video processing pipelines and maintain high parallelism, it is important to add some level of abstraction and 
let client programmers define what tasks to execute.

Here are some of the tasks that can be applied on a video file:
- Inspection: Make sure videos have good quality and are not malformed.
- Thumbnail. Thumbnails can either be uploaded by a user or automatically generated by the system.
- Watermark: An image overlay on top of your video contains identifying information about your video.

### Speed Optimization

- Parallelize video uploading. Split a video into smaller chunks.
- Place upload centers close to users.

### Safety Optimization

- Digital rights management (DRM) systems: Three major DRM systems are Apple FairPlay, Google Widevine, and Microsoft PlayReady.
- AES encryption: Encrypt a video and configure an authorization policy.  The encrypted video will be decrypted upon playback. 
This ensures that only authorized users can watch an encrypted video.
- Visual watermarking: This is an image overlay on top of your video that contains identifying information for your video. 
It can be your company logo or company name.


### Reference

1. https://bytebytego.com/courses/system-design-interview/design-youtube
